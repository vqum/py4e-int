<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>21.8. Programming with multiple tables &#8212; Python for Everybody - Interactive</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/matrixeq.css?v=58BC228F" />
    <link rel="stylesheet" type="text/css" href="../_static/webgldemo.css?v=B36B48D" />
    <link rel="stylesheet" type="text/css" href="../_static/webglinteractive.css?v=910DF1E1" />
    <link rel="stylesheet" type="text/css" href="../_static/CodeChat.css" />
    <link rel="stylesheet" type="text/css" href="../_static/accessibility.css?v=50109A2C" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/637.css?v=bddd2011b20db76a20ea" />
    <link rel="stylesheet" type="text/css" href="../_static/runestone.css?v=7c5388ad4389eae1a318" />



    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/matrixeq.js?v=D64CFA5A"></script>
    <script src="../_static/webglinteractive.js?v=2B768384"></script>
    <script src="../_static/FileSaver.min.js?v=8408C997"></script>
    <script src="../_static/html4css1.css?v=4533ACD3"></script>
    <script src="../_static/animationbase.js?v=A043C3A7"></script>
    <script src="../_static/runtime.bundle.js?v=aa7c717c38c5405af9e6"></script>
    <script src="../_static/637.bundle.js?v=1123ad75f9b821cdd636"></script>
    <script src="../_static/runestone.bundle.js?v=9c8e466e8cbed4a3af5a"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="21.9. Three kinds of keys" href="3Keys.html" />
    <link rel="prev" title="21.7. Basic data modeling" href="basicModeling.html" />


<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />


<script>
  eBookConfig = {};
  
    eBookConfig.useRunestoneServices = true;
    eBookConfig.host = 'http://127.0.0.1:8000' || 'http://127.0.0.1:8000';
    eBookConfig.app = eBookConfig.host+'/runestone';
    eBookConfig.course = 'py4e-int';
    eBookConfig.basecourse = 'py4e-int';
    eBookConfig.isLoggedIn = false;
    eBookConfig.enableCompareMe = eBookConfig.useRunestoneServices;
  
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.logLevel = 10;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.python3 = true;
  eBookConfig.acDefaultLanguage = '' ? '' : 'python'
  eBookConfig.runestone_version = '';
  eBookConfig.jobehost = '';
  eBookConfig.proxyuri_runs = '';
  eBookConfig.proxyuri_files = '';
  eBookConfig.enable_chatcodes = false ? false : false;

</script>

<!-- Ad Serving Headers Only serve ads to Anonymous Users -->



  </head><body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse" aria-label="navbar toggle">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        
        
          <a class="brand-logo" href="/runestone/default/user/login" aria-label="Login"><img src="../_static/img/logo_small.png" alt=""></a>
        
        <a class="navbar-brand" href="../index.html" aria-label="index-page">
          
          py4e-int
        </a>
      </div>
    </div>



    <div class="navbar-collapse collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav navbar-right" >

        <li class="divider-vertical"></li>


        <!-- social media dropdown -->
        
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-globe" style="opacity: 0.9"><span class="visuallyhidden" aria-label="Social">Social</span></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone">Follow @iRunestone</a>
                <a href="https://www.facebook.com/RunestoneInteractive">Our Facebook Page</a>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li><!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'><span class="visuallyhidden" aria-label="Search">Search</span></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html' aria-label="index-page">Table of Contents</a></li>
            
            <li><a href='../genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        
        <!-- user account dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-user" style="opacity:0.9;"><span class="visuallyhidden" aria-label="User">User</span></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><span class='loggedinuser'></span></li>
            <li class="divider"></li>
            <li><a href='/runestone/assignments/chooseAssignment.html'>Assignments</a></li>
            <li><a href='/runestone/assignments/practice'>Practice</a></li>
            <li class="divider"></li>
            
            <li><a href='/runestone/default/courses'>Change Course</a></li>
			      <li class="divider"></li>
            <li id="ip_dropdown_link"><a href='/runestone/admin/index'>Instructor's Page</a></li>
            
            <li><a href='/runestone/dashboard/studentreport'>Progress Page</a></li>
            <li class="divider"></li>
            
            <li><a href="/runestone/default/user/profile" id="profilelink">Edit Profile</a></li>
            <li><a href="/runestone/default/user/change_password" id="passwordlink">Change Password</a></li>
            <li><a href="/runestone/default/user/register" id="registerlink">Register</a></li>
            
            <li class='loginout'><a href='#'>Login</a></li> <!-- correct link populated by addNavbarLoginLink() -->
			<!-- dark mode toggle -->
             <li><label class="theme-switch" for="checkbox">
					  <input type="checkbox" id="checkbox" onchange="runestoneComponents.switchTheme()" />
							<div class="slider round"></div>
					</label>Dark Mode</li>
			 </ul>
        </li>
        <!-- end user account dropdown -->
        
        <li class="divider-vertical"></li>
        <!-- <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li> -->

        <!-- <li class="dropdown">             -->
          <li id="scratch_ac_link" class="dropdown"><a href="javascript:runestoneComponents.popupScratchAC()">
              <i class="glyphicon glyphicon-pencil" style="opacity:0.9;"><span class="visuallyhidden" aria-label="Scratch Activecode" >Scratch Activecode</span></i></a></li>
        <!-- </li> -->

        <li class="divider-vertical"></li>

        
        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"><span class="visuallyhidden" aria-label="Help">Help</span></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='http://runestoneinteractive.org/pages/faq.html'>FAQ</a></li>
            <li><a href='https://runestone.academy/runestone/static/instructorguide/index.html'>Instructors Guide</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='/runestone/default/reportabug?course=py4e-int&page=multTables'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>
      
      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          
          <li class="divider-vertical"></li>
        
        <!-- 
          
  <li id="relations-prev" title="Previous Chapter - <span class="section-number">21.7. </span>Basic data modeling" data-toggle="tooltip">
    <a href="basicModeling.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - <span class="section-number">21.9. </span>Three kinds of keys' data-toggle="tooltip" >              
    <a href="3Keys.html" >
        <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script>
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  window.addEventListener('load', (event) => {
    $('#relations-prev').tooltip(opts);
    $('#relations-next').tooltip(opts);
  });
</script>
        -->
        
          <li></li>
        
      </ul>
      </div> <!-- navbar-collapse -->
    </div> <!-- navbar -->
  </div> <!-- container -->


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content" role="main">
  
<!-- Ad Serving for Runestone Campaign -->


  
  <div class="section" id="programming-with-multiple-tables">
<h1><span class="section-number">21.8. </span>Programming with multiple tables<a class="headerlink" href="#programming-with-multiple-tables" title="Permalink to this headline">¶</a></h1>
<p id="index-0">We will now redo the Twitter spider program using two tables, the
primary keys, and the key references as described above. Here is the
code for the new version of the program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.request</span><span class="o">,</span> <span class="nn">urllib.parse</span><span class="o">,</span> <span class="nn">urllib.error</span>
<span class="kn">import</span> <span class="nn">twurl</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">ssl</span>

<span class="n">TWITTER_URL</span> <span class="o">=</span> <span class="s1">&#39;https://api.twitter.com/1.1/friends/list.json&#39;</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;friends.sqlite&#39;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE IF NOT EXISTS People</span>
<span class="s1">            (id INTEGER PRIMARY KEY, name TEXT UNIQUE, retrieved INTEGER)&#39;&#39;&#39;</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE IF NOT EXISTS Follows</span>
<span class="s1">            (from_id INTEGER, to_id INTEGER, UNIQUE(from_id, to_id))&#39;&#39;&#39;</span><span class="p">)</span>

<span class="c1"># Ignore SSL certificate errors</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">check_hostname</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CERT_NONE</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">acct</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter a Twitter account, or quit: &#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">acct</span> <span class="o">==</span> <span class="s1">&#39;quit&#39;</span><span class="p">):</span> <span class="k">break</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acct</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT id, name FROM People WHERE retrieved=0 LIMIT 1&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">acct</span><span class="p">)</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No unretrieved Twitter accounts found&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT id FROM People WHERE name = ? LIMIT 1&#39;</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">acct</span><span class="p">,</span> <span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;INSERT OR IGNORE INTO People</span>
<span class="s1">                        (name, retrieved) VALUES (?, 0)&#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">acct</span><span class="p">,</span> <span class="p">))</span>
            <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cur</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error inserting account:&#39;</span><span class="p">,</span> <span class="n">acct</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">lastrowid</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">twurl</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">TWITTER_URL</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;screen_name&#39;</span><span class="p">:</span> <span class="n">acct</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="s1">&#39;100&#39;</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Retrieving account&#39;</span><span class="p">,</span> <span class="n">acct</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Failed to Retrieve&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
        <span class="k">break</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remaining&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;x-rate-limit-remaining&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">js</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unable to parse json&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">break</span>

    <span class="c1"># Debugging</span>
    <span class="c1"># print(json.dumps(js, indent=4))</span>

    <span class="k">if</span> <span class="s1">&#39;users&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">js</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Incorrect JSON received&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">js</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
        <span class="k">continue</span>

    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;UPDATE People SET retrieved=1 WHERE name = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">acct</span><span class="p">,</span> <span class="p">))</span>

    <span class="n">countnew</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">countold</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">js</span><span class="p">[</span><span class="s1">&#39;users&#39;</span><span class="p">]:</span>
        <span class="n">friend</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;screen_name&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT id FROM People WHERE name = ? LIMIT 1&#39;</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">friend</span><span class="p">,</span> <span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">friend_id</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">countold</span> <span class="o">=</span> <span class="n">countold</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;INSERT OR IGNORE INTO People (name, retrieved)</span>
<span class="s1">                        VALUES (?, 0)&#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">friend</span><span class="p">,</span> <span class="p">))</span>
            <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cur</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error inserting account:&#39;</span><span class="p">,</span> <span class="n">friend</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">friend_id</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">lastrowid</span>
            <span class="n">countnew</span> <span class="o">=</span> <span class="n">countnew</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;INSERT OR IGNORE INTO Follows (from_id, to_id)</span>
<span class="s1">                    VALUES (?, ?)&#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">friend_id</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New accounts=&#39;</span><span class="p">,</span> <span class="n">countnew</span><span class="p">,</span> <span class="s1">&#39; revisited=&#39;</span><span class="p">,</span> <span class="n">countold</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remaining&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;x-rate-limit-remaining&#39;</span><span class="p">])</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>This program is starting to get a bit complicated, but it illustrates
the patterns that we need to use when we are using integer keys to link
tables. The basic patterns are:</p>
<ul class="simple">
<li><p>Create tables with primary keys and constraints.</p></li>
<li><p>When we have a logical key for a person (i.e., account name) and we need the
<code class="docutils literal notranslate"><span class="pre">id</span></code> value for the person, depending on whether or not the person is already
in the <code class="docutils literal notranslate"><span class="pre">People</span></code> table we either need to: (1) look up the person in the <code class="docutils literal notranslate"><span class="pre">People</span></code>
table and retrieve the <code class="docutils literal notranslate"><span class="pre">id</span></code> value for the person or (2) add the person to the
<code class="docutils literal notranslate"><span class="pre">People</span></code> table and get the <code class="docutils literal notranslate"><span class="pre">id</span></code> value for the newly added row.</p></li>
<li><p>Insert the row that captures the “follows” relationship.</p></li>
</ul>
<p>We will cover each of these in turn.</p>
<div class="section" id="constraints-in-database-tables">
<h2><span class="section-number">21.8.1. </span>Constraints in database tables<a class="headerlink" href="#constraints-in-database-tables" title="Permalink to this headline">¶</a></h2>
<p>As we design our table structures, we can tell the database system that
we would like it to enforce a few rules on us. These rules help us from
making mistakes and introducing incorrect data into out tables. When we
create our tables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE IF NOT EXISTS People</span>
<span class="s1">    (id INTEGER PRIMARY KEY, name TEXT UNIQUE, retrieved INTEGER)&#39;&#39;&#39;</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE IF NOT EXISTS Follows</span>
<span class="s1">    (from_id INTEGER, to_id INTEGER, UNIQUE(from_id, to_id))&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We indicate that the <code class="docutils literal notranslate"><span class="pre">name</span></code> column in the <code class="docutils literal notranslate"><span class="pre">People</span></code>
table must be <code class="docutils literal notranslate"><span class="pre">UNIQUE</span></code>. We also indicate that the combination
of the two numbers in each row of the <code class="docutils literal notranslate"><span class="pre">Follows</span></code> table must be
unique. These constraints keep us from making mistakes such as adding
the same relationship more than once.</p>
<p>We can take advantage of these constraints in the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;INSERT OR IGNORE INTO People (name, retrieved)</span>
<span class="s1">    VALUES ( ?, 0)&#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span> <span class="n">friend</span><span class="p">,</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>We add the <code class="docutils literal notranslate"><span class="pre">OR</span> <span class="pre">IGNORE</span></code> clause to our <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>
statement to indicate that if this particular <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> would
cause a violation of the “<code class="docutils literal notranslate"><span class="pre">name</span></code> must be unique” rule, the
database system is allowed to ignore the <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>. We are
using the database constraint as a safety net to make sure we don’t
inadvertently do something incorrect.</p>
<p>Similarly, the following code ensures that we don’t add the exact same
<code class="docutils literal notranslate"><span class="pre">Follows</span></code> relationship twice.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;INSERT OR IGNORE INTO Follows</span>
<span class="s1">    (from_id, to_id) VALUES (?, ?)&#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">friend_id</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>Again, we simply tell the database to ignore our attempted
<code class="docutils literal notranslate"><span class="pre">INSERT</span></code> if it would violate the uniqueness constraint that
we specified for the <code class="docutils literal notranslate"><span class="pre">Follows</span></code> rows.</p>

            <div class="runestone alert alert-warning">
            <ul data-component="multiplechoice" data-question_label="21.8.1.1" data-multipleanswers="false"  id="dbMult_MC_tf1"  style="visibility: hidden;">
            <p>Q-1: True or False? You can instruct SQL to ignore a command.</p>

            <li data-component="answer" data-correct id="dbMult_MC_tf1_opt_a">True</li><li data-component="feedback">By using the command "OR IGNORE" you can instruct SQL to skip a command if it invalidates a constraint.</li>
            
            <li data-component="answer"  id="dbMult_MC_tf1_opt_b">False</li><li data-component="feedback">Try again!</li>
            

            </ul>
            </div>
            </div>
<div class="section" id="retrieve-and-or-insert-a-record">
<h2><span class="section-number">21.8.2. </span>Retrieve and/or insert a record<a class="headerlink" href="#retrieve-and-or-insert-a-record" title="Permalink to this headline">¶</a></h2>
<p>When we prompt the user for a Twitter account, if the account exists, we
must look up its <code class="docutils literal notranslate"><span class="pre">id</span></code> value. If the account does not yet
exist in the <code class="docutils literal notranslate"><span class="pre">People</span></code> table, we must insert the record and
get the <code class="docutils literal notranslate"><span class="pre">id</span></code> value from the inserted row.</p>
<p>This is a very common pattern and is done twice in the program above.
This code shows how we look up the <code class="docutils literal notranslate"><span class="pre">id</span></code> for a friend’s
account when we have extracted a <code class="docutils literal notranslate"><span class="pre">screen_name</span></code> from a <code class="docutils literal notranslate"><span class="pre">user</span></code>
node in the retrieved Twitter JSON.</p>
<p>Since over time it will be increasingly likely that the account will
already be in the database, we first check to see if the
<code class="docutils literal notranslate"><span class="pre">People</span></code> record exists using a <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> statement.</p>
<p>If all goes well <a class="footnote-reference brackets" href="#id2" id="id1">1</a> inside
the <code class="docutils literal notranslate"><span class="pre">try</span></code> section, we retrieve
the record using <code class="docutils literal notranslate"><span class="pre">fetchone()</span></code> and then retrieve the first
(and only) element of the returned tuple and store it in <code class="docutils literal notranslate"><span class="pre">friend_id</span></code>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> fails, the <code class="docutils literal notranslate"><span class="pre">fetchone()[0]</span></code> code
will fail and control will transfer into the <code class="docutils literal notranslate"><span class="pre">except</span></code>
section.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">friend</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;screen_name&#39;</span><span class="p">]</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT id FROM People WHERE name = ? LIMIT 1&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="n">friend</span><span class="p">,</span> <span class="p">)</span> <span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">friend_id</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">countold</span> <span class="o">=</span> <span class="n">countold</span> <span class="o">+</span> <span class="mi">1</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;INSERT OR IGNORE INTO People (name, retrieved)</span>
<span class="s1">        VALUES ( ?, 0)&#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span> <span class="n">friend</span><span class="p">,</span> <span class="p">)</span> <span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cur</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error inserting account:&#39;</span><span class="p">,</span><span class="n">friend</span><span class="p">)</span>
        <span class="k">continue</span>
    <span class="n">friend_id</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">lastrowid</span>
    <span class="n">countnew</span> <span class="o">=</span> <span class="n">countnew</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>If we end up in the <code class="docutils literal notranslate"><span class="pre">except</span></code> code, it simply means that the
row was not found, so we must insert the row. We use <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">OR</span>
<span class="pre">IGNORE</span></code> just to avoid errors and then call <code class="docutils literal notranslate"><span class="pre">commit()</span></code>
to force the database to really be updated. After the write is done, we
can check the <code class="docutils literal notranslate"><span class="pre">cur.rowcount</span></code> to see how many rows were
affected. Since we are attempting to insert a single row, if the number
of affected rows is something other than 1, it is an error.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> is successful, we can look at
<code class="docutils literal notranslate"><span class="pre">cur.lastrowid</span></code> to find out what value the database assigned
to the <code class="docutils literal notranslate"><span class="pre">id</span></code> column in our newly created row.</p>

            <div class="runestone alert alert-warning">
            <ul data-component="multiplechoice" data-question_label="21.8.2.1" data-multipleanswers="false"  id="dbMult_MC_tf2"  style="visibility: hidden;">
            <p>Q-2: True or False? SQL will automatically check if something already exists in your data.</p>

            <li data-component="answer"  id="dbMult_MC_tf2_opt_a">True</li><li data-component="feedback">Try again!</li>
            
            <li data-component="answer" data-correct id="dbMult_MC_tf2_opt_b">False</li><li data-component="feedback">Before adding new data to a table, you should check if it already exists or use INSERT OR IGNORE.</li>
            

            </ul>
            </div>
            </div>
<div class="section" id="storing-the-friend-relationship">
<h2><span class="section-number">21.8.3. </span>Storing the friend relationship<a class="headerlink" href="#storing-the-friend-relationship" title="Permalink to this headline">¶</a></h2>
<p>Once we know the key value for both the Twitter user and the friend in
the JSON, it is a simple matter to insert the two numbers into the
<code class="docutils literal notranslate"><span class="pre">Follows</span></code> table with the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;INSERT OR IGNORE INTO Follows (from_id, to_id) VALUES (?, ?)&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">friend_id</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>Notice that we let the database take care of keeping us from
“double-inserting” a relationship by creating the table with a
uniqueness constraint and then adding <code class="docutils literal notranslate"><span class="pre">OR</span> <span class="pre">IGNORE</span></code> to our
<code class="docutils literal notranslate"><span class="pre">INSERT</span></code> statement.</p>
<p>Here is a sample execution of this program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Enter</span> <span class="n">a</span> <span class="n">Twitter</span> <span class="n">account</span><span class="p">,</span> <span class="ow">or</span> <span class="n">quit</span><span class="p">:</span>
<span class="n">No</span> <span class="n">unretrieved</span> <span class="n">Twitter</span> <span class="n">accounts</span> <span class="n">found</span>
<span class="n">Enter</span> <span class="n">a</span> <span class="n">Twitter</span> <span class="n">account</span><span class="p">,</span> <span class="ow">or</span> <span class="n">quit</span><span class="p">:</span> <span class="n">drchuck</span>
<span class="n">Retrieving</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mf">1.1</span><span class="o">/</span><span class="n">friends</span> <span class="o">...</span>
<span class="n">New</span> <span class="n">accounts</span><span class="o">=</span> <span class="mi">20</span>  <span class="n">revisited</span><span class="o">=</span> <span class="mi">0</span>
<span class="n">Enter</span> <span class="n">a</span> <span class="n">Twitter</span> <span class="n">account</span><span class="p">,</span> <span class="ow">or</span> <span class="n">quit</span><span class="p">:</span>
<span class="n">Retrieving</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mf">1.1</span><span class="o">/</span><span class="n">friends</span> <span class="o">...</span>
<span class="n">New</span> <span class="n">accounts</span><span class="o">=</span> <span class="mi">17</span>  <span class="n">revisited</span><span class="o">=</span> <span class="mi">3</span>
<span class="n">Enter</span> <span class="n">a</span> <span class="n">Twitter</span> <span class="n">account</span><span class="p">,</span> <span class="ow">or</span> <span class="n">quit</span><span class="p">:</span>
<span class="n">Retrieving</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mf">1.1</span><span class="o">/</span><span class="n">friends</span> <span class="o">...</span>
<span class="n">New</span> <span class="n">accounts</span><span class="o">=</span> <span class="mi">17</span>  <span class="n">revisited</span><span class="o">=</span> <span class="mi">3</span>
<span class="n">Enter</span> <span class="n">a</span> <span class="n">Twitter</span> <span class="n">account</span><span class="p">,</span> <span class="ow">or</span> <span class="n">quit</span><span class="p">:</span> <span class="n">quit</span>
</pre></div>
</div>
<p>We started with the <code class="docutils literal notranslate"><span class="pre">drchuck</span></code> account and then let the
program automatically pick the next two accounts to retrieve and add to
our database.</p>
<p>The following is the first few rows in the <code class="docutils literal notranslate"><span class="pre">People</span></code> and
<code class="docutils literal notranslate"><span class="pre">Follows</span></code> tables after this run is completed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">People</span><span class="p">:</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;drchuck&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;opencontent&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;lhawthorn&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;steve_coppin&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;davidkocher&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="mi">55</span> <span class="n">rows</span><span class="o">.</span>
<span class="n">Follows</span><span class="p">:</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="mi">60</span> <span class="n">rows</span><span class="o">.</span>
</pre></div>
</div>
<p>You can see the <code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code>, and
<code class="docutils literal notranslate"><span class="pre">visited</span></code> fields in the <code class="docutils literal notranslate"><span class="pre">People</span></code> table and you see
the numbers of both ends of the relationship in the <code class="docutils literal notranslate"><span class="pre">Follows</span></code>
table. In the <code class="docutils literal notranslate"><span class="pre">People</span></code> table, we can see that the first three
people have been visited and their data has been retrieved. The data in
the <code class="docutils literal notranslate"><span class="pre">Follows</span></code> table indicates that <code class="docutils literal notranslate"><span class="pre">drchuck</span></code> (user
1) is a friend to all of the people shown in the first five rows. This
makes sense because the first data we retrieved and stored was the
Twitter friends of <code class="docutils literal notranslate"><span class="pre">drchuck</span></code>. If you were to print more rows
from the <code class="docutils literal notranslate"><span class="pre">Follows</span></code> table, you would see the friends of users
2 and 3 as well.</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>In general, when a sentence starts with “if all goes well” you will find that
the code needs to use try/except.</p>
</dd>
</dl>
</div>
</div>


  <div id="scprogresscontainer">
    You have attempted <span id="scprogresstotal"></span> of <span id="scprogressposs"></span> activities on this page <div id="subchapterprogress" aria-label="Page progress"></div>
  </div>

  <ul role="navigation" class="nextprev-list nextprev-list" aria-label="Change page">
<li id="relations-prev" class="navLink" title='Previous Section - 21.7. Basic data modeling' data-toggle="tooltip">
  <a href="basicModeling.html" aria-label="Previous - 21.7. Basic data modeling">
    <i class='prevNav glyphicon glyphicon-chevron-left'  style="top:50%; transform:translateY(-50%)translateX(-50%); left: 50%; color:black;"></i>
  </a>
</li>

  <li id="relations-next" class="navLink" title='Next Section - 21.9. Three kinds of keys' data-toggle="tooltip" >
    <a href="3Keys.html" aria-label="Next - 21.9. Three kinds of keys">
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right' style="top:50%; transform:translateY(-50%)translateX(-50%); left: 50%; color:black; "></i>
    </a>
  </li>
</ul>

<script>
window.addEventListener('load', (event) => {
  $('#relations-prev').tooltip({'placement': 'right', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement': 'left', 'delay': { show: 100, hide: 50}});
});
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      
      <span id='numuserspan'></span><span class='loggedinuser'></span>
      
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020 - Based on Python for Everybody.
      Created using <a href="http://runestoneinteractive.org/">Runestone</a> .
    </p>
  </div>
</footer>




<script> 
  window.addEventListener('load', (event) => {
    runestoneComponents.getSwitch(); 
  });
</script>


  </body>
</html>