(self.webpackChunkWebComponents=self.webpackChunkWebComponents||[]).push([[309],{2568:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var s=i(21294);class r{constructor(e){this.component_ready_promise=new Promise((e=>this._component_ready_resolve_fn=e)),this.optional=!1,void 0===window.allComponents&&(window.allComponents=[]),window.allComponents.push(this),e&&(this.sid=e.sid,this.graderactive=e.graderactive,this.showfeedback=!0,e.timed&&(this.isTimed=!0),e.enforceDeadline&&(this.deadline=e.deadline),$(e.orig).data("optional")?this.optional=!0:this.optional=!1,e.selector_id&&(this.selector_id=e.selector_id),void 0!==e.assessmentTaken?this.assessmentTaken=e.assessmentTaken:this.assessmentTaken=!0,void 0!==e.timedWrapper?this.timedWrapper=e.timedWrapper:location.href.indexOf("doAssignment")>=0?this.timedWrapper=$("h1#assignment_name").text():this.timedWrapper=null,$(e.orig).data("question_label")&&(this.question_label=$(e.orig).data("question_label"))),this.jsonHeaders=new Headers({"Content-type":"application/json; charset=utf-8",Accept:"application/json"})}async logBookEvent(e){if(this.graderactive)return;let t;return e.course=eBookConfig.course,e.clientLoginStatus=eBookConfig.isLoggedIn,e.timezoneoffset=(new Date).getTimezoneOffset()/60,this.percent&&(e.percent=this.percent),eBookConfig.useRunestoneServices&&eBookConfig.logLevel>0&&(t=this.postLogMessage(e)),this.isTimed&&!eBookConfig.debug||console.log("logging event "+JSON.stringify(e)),this.selector_id&&(e.div_id=this.selector_id.replace("-toggleSelectedQuestion",""),e.event="selectquestion",e.act="interaction",this.postLogMessage(e)),"function"==typeof s.j.updateProgress&&"edit"!=e.act&&0==this.optional&&s.j.updateProgress(e.div_id),t}async postLogMessage(e){var t;let i=new Request(eBookConfig.ajaxURL+"hsblog",{method:"POST",headers:this.jsonHeaders,body:JSON.stringify(e)});try{let e=await fetch(i);if(!e.ok)throw new Error("Failed to save the log entry");t=e.json()}catch(e){this.isTimed&&alert(`Error: Your action was not saved! The error was ${e}`),console.log(`Error: ${e}`)}return t}async logRunEvent(e){let t="done";if(!this.graderactive){if(e.course=eBookConfig.course,e.clientLoginStatus=eBookConfig.isLoggedIn,e.timezoneoffset=(new Date).getTimezoneOffset()/60,(this.forceSave||"to_save"in e==0)&&(e.save_code="True"),eBookConfig.useRunestoneServices&&eBookConfig.logLevel>0){let i=new Request(eBookConfig.ajaxURL+"runlog.json",{method:"POST",headers:this.jsonHeaders,body:JSON.stringify(e)}),s=await fetch(i);if(!s.ok)throw new Error("Failed to log the run");t=await s.json()}return this.isTimed&&!eBookConfig.debug||console.log("running "+JSON.stringify(e)),"function"==typeof s.j.updateProgress&&0==this.optional&&s.j.updateProgress(e.div_id),t}}async checkServer(e,t=!1){let i=this;if(this.checkServerComplete=new Promise((function(e,t){i.csresolver=e})),this.useRunestoneServices||this.graderactive){let t={};if(t.div_id=this.divid,t.course=eBookConfig.course,t.event=e,this.graderactive&&this.deadline&&(t.deadline=this.deadline,t.rawdeadline=this.rawdeadline,t.tzoff=this.tzoff),this.sid&&(t.sid=this.sid),!eBookConfig.practice_mode&&this.assessmentTaken){let e=new Request(eBookConfig.ajaxURL+"getAssessResults",{method:"POST",body:JSON.stringify(t),headers:this.jsonHeaders});try{let i=await fetch(e);t=await i.json(),this.repopulateFromStorage(t),this.csresolver("server")}catch(e){try{this.checkLocalStorage()}catch(e){console.log(e)}}}else this.loadData({}),this.csresolver("not taken")}else this.checkLocalStorage(),this.csresolver("local");t&&this.indicate_component_ready()}indicate_component_ready(){this.containerDiv.classList.add("runestone-component-ready"),this._component_ready_resolve_fn()}loadData(e){return null}repopulateFromStorage(e){null!==e&&this.shouldUseServer(e)?(this.restoreAnswers(e),this.setLocalStorage(e)):this.checkLocalStorage()}shouldUseServer(e){if("T"===e.correct||0===localStorage.length||!0===this.graderactive||this.isTimed)return!0;let t,i=localStorage.getItem(this.localStorageKey());if(null===i)return!0;try{t=JSON.parse(i)}catch(e){return console.log(e.message),localStorage.removeItem(this.localStorageKey()),!0}if(e.answer==t.answer)return!0;let s=new Date(t.timestamp);return new Date(e.timestamp)>=s}localStorageKey(){return eBookConfig.email+":"+eBookConfig.course+":"+this.divid+"-given"}addCaption(e){if(!this.isTimed){var t=document.createElement("p");this.question_label?(this.caption=`Activity: ${this.question_label} ${this.caption}  <span class="runestone_caption_divid">(${this.divid})</span>`,$(t).html(this.caption),$(t).addClass(`${e}_caption`)):($(t).html(this.caption+" ("+this.divid+")"),$(t).addClass(`${e}_caption`),$(t).addClass(`${e}_caption_text`)),this.capDiv=t,this.containerDiv.appendChild(t)}}hasUserActivity(){return this.isAnswered}checkCurrentAnswer(){console.log("Each component should provide an implementation of checkCurrentAnswer")}async logCurrentAnswer(){console.log("Each component should provide an implementation of logCurrentAnswer")}renderFeedback(){console.log("Each component should provide an implementation of renderFeedback")}disableInteraction(){console.log("Each component should provide an implementation of disableInteraction")}toString(){return`${this.constructor.name}: ${this.divid}`}queueMathJax(e){"2"===MathJax.version.substring(0,1)?MathJax.Hub.Queue(["Typeset",MathJax.Hub,e]):MathJax.typesetPromise([e])}}window.RunestoneBase=r},86151:()=>{$.i18n().load({en:{msg_no_answer:"No answer provided.",msg_fitb_check_me:"Check me",msg_fitb_compare_me:"Compare me"}})},61353:()=>{$.i18n().load({"pt-br":{msg_no_answer:"Nenhuma resposta dada.",msg_fitb_check_me:"Verificar",msg_fitb_compare_me:"Comparar"}})},99184:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>FITB});var _common_js_runestonebase_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2568),_fitb_i18n_en_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(86151),_fitb_i18n_en_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_fitb_i18n_en_js__WEBPACK_IMPORTED_MODULE_1__),_fitb_i18n_pt_br_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(61353),_fitb_i18n_pt_br_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_fitb_i18n_pt_br_js__WEBPACK_IMPORTED_MODULE_2__),FITBList={};class FITB extends _common_js_runestonebase_js__WEBPACK_IMPORTED_MODULE_0__.Z{constructor(e){super(e);var t=e.orig;this.useRunestoneServices=e.useRunestoneServices,this.origElem=t,this.divid=t.id,this.correct=null,this.feedbackArray=JSON.parse(this.scriptSelector(this.origElem).html()),this.createFITBElement(),this.caption="Fill in the Blank",this.addCaption("runestone"),this.checkServer("fillb",!0)}scriptSelector(e){return $(e).find('script[type="application/json"]')}createFITBElement(){this.renderFITBInput(),this.renderFITBButtons(),this.renderFITBFeedbackDiv(),$(this.origElem).replaceWith(this.containerDiv)}renderFITBInput(){this.containerDiv=document.createElement("div"),$(this.containerDiv).addClass("alert alert-warning"),this.containerDiv.id=this.divid,$(this.origElem).children().clone().appendTo(this.containerDiv),this.scriptSelector(this.containerDiv).remove();let e=$(this.containerDiv).find(":input");e.attr("class","form form-control selectwidthauto"),e.attr("aria-label","input area"),this.blankArray=e.toArray();for(let e of this.blankArray)$(e).change(this.recordAnswered.bind(this))}recordAnswered(){this.isAnswered=!0}renderFITBButtons(){this.submitButton=document.createElement("button"),this.submitButton.textContent=$.i18n("msg_fitb_check_me"),$(this.submitButton).attr({class:"btn btn-success",name:"do answer",type:"button"}),this.submitButton.addEventListener("click",function(){this.checkCurrentAnswer(),this.logCurrentAnswer()}.bind(this),!1),this.containerDiv.appendChild(document.createElement("br")),this.containerDiv.appendChild(document.createElement("br")),this.containerDiv.appendChild(this.submitButton),this.useRunestoneServices&&(this.compareButton=document.createElement("button"),$(this.compareButton).attr({class:"btn btn-default",id:this.origElem.id+"_bcomp",disabled:"",name:"compare"}),this.compareButton.textContent=$.i18n("msg_fitb_compare_me"),this.compareButton.addEventListener("click",function(){this.compareFITBAnswers()}.bind(this),!1),this.containerDiv.appendChild(this.compareButton)),this.containerDiv.appendChild(document.createElement("div"))}renderFITBFeedbackDiv(){this.feedBackDiv=document.createElement("div"),this.feedBackDiv.id=this.divid+"_feedback",this.containerDiv.appendChild(document.createElement("br")),this.containerDiv.appendChild(this.feedBackDiv)}restoreAnswers(e){var t;try{if(t=JSON.parse(e.answer),!Array.isArray(t))throw new Error}catch(i){t=e.answer.split(",")}for(var i=0;i<this.blankArray.length;i++)$(this.blankArray[i]).attr("value",t[i]);this.feedbackArray?this.checkCurrentAnswer():(this.displayFeed=e.displayFeed,this.correct=e.correct,this.isCorrectArray=e.isCorrectArray,void 0!==this.displayFeed&&void 0!==this.correct&&void 0!==this.isCorrectArray&&this.renderFeedback())}checkLocalStorage(){var e;if(!this.graderactive&&localStorage.length>0){var t=localStorage.getItem(this.localStorageKey());if(null!==t){try{(e=JSON.parse(t)).answer}catch(e){return console.log(e.message),void localStorage.removeItem(this.localStorageKey())}this.restoreAnswers(e)}}}setLocalStorage(e){let t=this.localStorageKey();localStorage.setItem(t,JSON.stringify(e))}checkCurrentAnswer(){this.isCorrectArray=[],this.displayFeed=[],this.given_arr=[];for(var e=0;e<this.blankArray.length;e++)this.given_arr.push(this.blankArray[e].value);this.useRunestoneServices&&eBookConfig.enableCompareMe&&this.enableCompareButton(),this.feedbackArray&&(this.evaluateAnswers(),this.isTimed||this.renderFeedback())}async logCurrentAnswer(e){let t=JSON.stringify(this.given_arr),i=!0;this.setLocalStorage({answer:t,timestamp:new Date});let s={event:"fillb",act:t,answer:t,correct:this.correct?"T":"F",div_id:this.divid};if(void 0!==e&&(s.sid=e,i=!1),s=await this.logBookEvent(s),i)return this.feedbackArray||(this.setLocalStorage({answer:t,timestamp:s.timestamp}),this.correct=s.correct,this.displayFeed=s.displayFeed,this.isCorrectArray=s.isCorrectArray,this.isTimed||this.renderFeedback()),s}evaluateAnswers(){this.correct=!0;for(var e=0;e<this.blankArray.length;e++){var t=this.blankArray[e].value;if(""===t)this.isCorrectArray.push(null),this.displayFeed.push($.i18n("msg_no_answer")),this.correct=!1;else{for(var i=this.feedbackArray[e]||[],s=0;s<i.length;s++){if(s===i.length-1){this.displayFeed.push(i[s].feedback);break}if("regex"in i[s]){if(RegExp(i[s].regex,i[s].regexFlags).test(t)){this.displayFeed.push(i[s].feedback);break}}else{console.assert("number"in i[s]);var[r,a]=i[s].number,n=+t;if(n>=r&&n<=a){this.displayFeed.push(i[s].feedback);break}}}let o=0===s&&i.length>1;this.isCorrectArray.push(o),o||(this.correct=!1)}}this.percent=this.isCorrectArray.filter(Boolean).length/this.blankArray.length}renderFeedback(){if(this.correct){$(this.feedBackDiv).attr("class","alert alert-info");for(let e=0;e<this.blankArray.length;e++)$(this.blankArray[e]).removeClass("input-validation-error")}else{null===this.displayFeed&&(this.displayFeed="");for(let e=0;e<this.blankArray.length;e++)!0!==this.isCorrectArray[e]?$(this.blankArray[e]).addClass("input-validation-error"):$(this.blankArray[e]).removeClass("input-validation-error");$(this.feedBackDiv).attr("class","alert alert-danger")}for(var e="<ul>",t=0;t<this.displayFeed.length;t++)e+="<li>"+this.displayFeed[t]+"</li>";e+="</ul>",1==this.displayFeed.length&&(e=e.slice("<ul><li>".length,-"</li></ul>".length)),this.feedBackDiv.innerHTML=e,"undefined"!=typeof MathJax&&this.queueMathJax(document.body)}enableCompareButton(){this.compareButton.disabled=!1}compareFITBAnswers(){var e={};e.div_id=this.divid,e.course=eBookConfig.course,jQuery.get(eBookConfig.ajaxURL+"gettop10Answers",e,this.compareFITB)}compareFITB(data,status,whatever){var answers=eval(data)[0],misc=eval(data)[1],body="<table>";for(var row in body+="<tr><th>Answer</th><th>Count</th></tr>",answers)body+="<tr><td>"+answers[row].answer+"</td><td>"+answers[row].count+" times</td></tr>";body+="</table>","unavailable"!==misc.yourpct&&(body+="<br /><p>You have "+misc.yourpct+"% correct for all questions</p>");var html="<div class='modal fade'>    <div class='modal-dialog compare-modal'>        <div class='modal-content'>            <div class='modal-header'>                <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>                <h4 class='modal-title'>Top Answers</h4>            </div>            <div class='modal-body'>"+body+"            </div>        </div>    </div></div>",el=$(html);el.modal()}disableInteraction(){for(var e=0;e<this.blankArray.length;e++)this.blankArray[e].disabled=!0}}$(document).bind("runestone:login-complete",(function(){$("[data-component=fillintheblank]").each((function(e){var t={orig:this,useRunestoneServices:eBookConfig.useRunestoneServices};if(0==$(this).closest("[data-component=timedAssessment]").length)try{FITBList[this.id]=new FITB(t)}catch(e){console.log(`Error rendering Fill in the Blank Problem ${this.id}\n                     Details: ${e}`)}}))}))},74309:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var s=i(99184);class r extends s.Z{constructor(e){super(e),this.renderTimedIcon(this.inputDiv),this.hideButtons(),this.needsReinitialization=!0}hideButtons(){$(this.submitButton).hide(),$(this.compareButton).hide()}renderTimedIcon(e){var t=document.createElement("div"),i=document.createElement("img");$(i).attr({src:"../_static/clock.png",style:"width:15px;height:15px"}),t.className="timeTip",t.title="",t.appendChild(i),$(e).prepend(t)}checkCorrectTimed(){switch(this.correct){case!0:return"T";case!1:return"F";default:return null}}hideFeedback(){for(var e=0;e<this.blankArray.length;e++)$(this.blankArray[e]).removeClass("input-validation-error");this.feedBackDiv.style.display="none"}reinitializeListeners(){for(let e of this.blankArray)$(e).change(this.recordAnswered.bind(this))}}void 0===window.component_factory&&(window.component_factory={}),window.component_factory.fillintheblank=function(e){return e.timed?new r(e):new s.Z(e)}}}]);
//# sourceMappingURL=309.bundle.js.map?v=5b2dfbf72b57b07d2ade