<!-- ****************************************
     |docname| - main template for this theme
     **************************************** -->
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>22.4. Visualizing mail data &#8212; Python for Everybody - Interactive</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/accessibility.css?v=50109A2C" />
    <link rel="stylesheet" type="text/css" href="../_static/CodeChat.css" />
    <link rel="stylesheet" type="text/css" href="../_static/matrixeq.css?v=58BC228F" />
    <link rel="stylesheet" type="text/css" href="../_static/webgldemo.css?v=B36B48D" />
    <link rel="stylesheet" type="text/css" href="../_static/webglinteractive.css?v=910DF1E1" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/vendors-node_modules_bootstrap_dist_js_bootstrap_js-node_modules_jquery-ui_jquery-ui_js-node_-72cd89.cd688d1623c9932e.css?v=630908D8" />
    <link rel="stylesheet" type="text/css" href="../_static/runestone.bf73008a1eba9f4e.css?v=7DED055E" />



    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/animationbase.js?v=A043C3A7"></script>
    <script src="../_static/html4css1.css?v=4533ACD3"></script>
    <script src="../_static/matrixeq.js?v=D64CFA5A"></script>
    <script src="../_static/webglinteractive.js?v=2B768384"></script>
    <script src="../_static/FileSaver.min.js?v=8408C997"></script>
    <script src="../_static/runtime.439d581f758f2b99.bundle.js?v=2E54442"></script>
    <script src="../_static/vendors-node_modules_bootstrap_dist_js_bootstrap_js-node_modules_jquery-ui_jquery-ui_js-node_-72cd89.51d9dde4e5162190.bundle.js?v=9CAA2D33"></script>
    <script src="../_static/runestone.42b576791a4ed54b.bundle.js?v=B7293199"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="22.5. Multiple Choice Questions" href="Exercises.html" />
    <link rel="prev" title="22.3. Visualizing networks and interconnections" href="visualizingnetworksandinterconnections.html" />


<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />


<script>
  eBookConfig = {};
  
    
    eBookConfig.useRunestoneServices = {{use_services}};
    eBookConfig.host = '';
    eBookConfig.app = eBookConfig.host + '/runestone';
    eBookConfig.course = '{{ course_name }}';
    eBookConfig.basecourse = '{{ base_course }}';
    eBookConfig.isLoggedIn = {{ is_logged_in}};
    eBookConfig.email = '{{ user_email }}';
    eBookConfig.isInstructor = {{ is_instructor }};
    eBookConfig.username = '{{ user_id}}';
    eBookConfig.readings = {{ readings|safe}};
    eBookConfig.activities = {{ activity_info|safe }}
    eBookConfig.downloadsEnabled = {{downloads_enabled}};
    eBookConfig.allow_pairs = {{allow_pairs}}
    eBookConfig.enableCompareMe = {{enable_compare_me}};
    // _`new_server_prefix`: Defined by the server to be the path to the new server.
    eBookConfig.new_server_prefix = '{{ new_server_prefix }}';
    
  
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.logLevel = 10;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.python3 = true;
  eBookConfig.acDefaultLanguage = '' ? '' : 'python'
  eBookConfig.runestone_version = '';
  eBookConfig.jobehost = '';
  eBookConfig.proxyuri_runs = '';
  eBookConfig.proxyuri_files = '';
  eBookConfig.enable_chatcodes = false ? false : false;
  eBookConfig.enableScratchAC = true;

</script>

<!-- Ad Serving Headers Only serve ads to Anonymous Users -->

    
        {% if serve_ad is defined and serve_ad and settings.adsenseid %}
         <script data-ad-client="{{settings.adsenseid}}" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        {% endif %}
    



  </head><body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse" aria-label="navbar toggle">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        
        
          <a class="brand-logo" href="/runestone/default/user/login" aria-label="Login"><img src="../_static/img/RAIcon.png" alt=""></a>
        
        <a class="navbar-brand" href="../index.html" aria-label="index-page">
          
            
            {{ course_name }}
            
          
        </a>
      </div>
    </div>



    <div class="navbar-collapse collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav navbar-right" >

        <li class="divider-vertical"></li>
        <li><span id="browsing_warning"></span></li>

        <!-- social media dropdown -->
        
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-globe" style="opacity: 0.9"><span class="visuallyhidden" aria-label="Social">Social</span></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone">Follow @iRunestone</a>
                <a href="https://www.facebook.com/RunestoneInteractive">Our Facebook Page</a>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li><!-- end social media dropdown -->

        <li class="divider-vertical"></li>
        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'><span class="visuallyhidden" aria-label="Search">Search</span></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html' aria-label="index-page">Table of Contents</a></li>
            
            <li><a href='../genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        
        <!-- user account dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-user" style="opacity:0.9;"><span class="visuallyhidden" aria-label="User">User</span></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><span class='loggedinuser'></span></li>
            <li class="divider"></li>
            <li><a href='/runestone/assignments/chooseAssignment.html'>Assignments</a></li>
            <li><a href='/runestone/assignments/practice'>Practice</a></li>
            <li id="inst_peer_link"><a href='/runestone/peer/instructor.html'>Peer Instruction (Instructor)</a></li>            
            <li><a href='/runestone/peer/student.html'>Peer Instruction (Student)</a></li>            
            <li class="divider"></li>
            
            <li><a href='/runestone/default/courses'>Change Course</a></li>
			      <li class="divider"></li>
            <li id="ip_dropdown_link"><a href='/runestone/admin/index'>Instructor's Page</a></li>
            
            <li><a href='/runestone/dashboard/studentreport'>Progress Page</a></li>
            <li class="divider"></li>
            
            <li><a href="/runestone/default/user/profile" id="profilelink">Edit Profile</a></li>
            <li><a href="/runestone/default/user/change_password" id="passwordlink">Change Password</a></li>
            <li><a href="/runestone/default/user/register" id="registerlink">Register</a></li>
            
            <li class='loginout'><a href='#'>Login</a></li> <!-- correct link populated by addNavbarLoginLink() -->
			<!-- dark mode toggle -->
             <li><label class="theme-switch" for="checkbox">
					  <input type="checkbox" id="checkbox" onchange="runestoneComponents.switchTheme()" />
							<div class="slider round"></div>
					</label>Dark Mode</li>
			 </ul>
        </li>
        <!-- end user account dropdown -->
        
        <li class="divider-vertical"></li>
        <!-- <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li> -->

        <!-- <li class="dropdown">             -->
          <li id="scratch_ac_link" class="dropdown"><a href="javascript:runestoneComponents.popupScratchAC()">
              <i class="glyphicon glyphicon-pencil" style="opacity:0.9;"><span class="visuallyhidden" aria-label="Scratch Activecode" >Scratch Activecode</span></i></a></li>
        <!-- </li> -->

        <li class="divider-vertical"></li>

        
        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"><span class="visuallyhidden" aria-label="Help">Help</span></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='http://runestoneinteractive.org/pages/faq.html'>FAQ</a></li>
            <li><a href='https://runestone.academy/ns/books/published/instructorguide/index.html'>Instructors Guide</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='/runestone/default/reportabug?course=py4e-int&page=visualizingmaildata'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>
      
      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          
            <script></script>
<li class="dropdown globaltoc-container">
    <a
        href="../index.html"
        class="dropdown-toggle"
        data-toggle="dropdown"
        aria-label="index"
        >This Chapter<b class="caret"></b
    ></a>
    <ul class="dropdown-menu globaltoc">
         
        {% for row in subchapter_list %}
        <li class="toctree-l1">
            <a class="reference internal" href="{{ row['subchap_uri']}}"
                >{{ row['title']}}</a
            >
        </li>
        {% endfor %} 
        
    </ul>
</li>
          
          <li class="divider-vertical"></li>
        
        <!-- 
          
  <li id="relations-prev" title="Previous Chapter - <span class="section-number">22.3. </span>Visualizing networks and interconnections" data-toggle="tooltip">
    <a href="visualizingnetworksandinterconnections.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - <span class="section-number">22.5. </span>Multiple Choice Questions' data-toggle="tooltip" >              
    <a href="Exercises.html" >
        <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script>
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  window.addEventListener('load', (event) => {
    $('#relations-prev').tooltip(opts);
    $('#relations-next').tooltip(opts);
  });
</script>
        -->
        
          <li></li>
        
      </ul>
      </div> <!-- navbar-collapse -->
    </div> <!-- navbar -->
  </div> <!-- container -->


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content" role="main">

<!-- Ad Serving for Runestone Campaign -->

    
        {% if settings.num_banners > 0 and settings.show_rs_banner %}
         <div style="width: 100%;">
            <a href="/runestone/default/donate?banner={{banner_num}}">
            <img class="runestone-banner"
                 src="/runestone/static/images/RunestoneBanner{{banner_num}}.png"
                 alt="Please Support Runestone"
                 style="display: block; width: 728px; margin-left: auto; margin-right: auto; margin-top: 10px;">
            </a>
         </div>
        {% endif %}
    


  
  <section id="visualizing-mail-data">
<h1><span class="section-number">22.4. </span>Visualizing mail data<a class="headerlink" href="#visualizing-mail-data" title="Permalink to this headline">¶</a></h1>
<p>Up to this point in the book, you have become quite familiar with our
<em>mbox-short.txt</em> and <em>mbox.txt</em> data
files. Now it is time to take our analysis of email data to the next
level.</p>
<p>In the real world, sometimes you have to pull down mail data from
servers. That might take quite some time and the data might be
inconsistent, error-filled, and need a lot of cleanup or adjustment. In
this section, we work with an application that is the most complex so
far and pull down nearly a gigabyte of data and visualize it.</p>
<a class="reference internal image-reference" href="../_images/wordcloud.png"><img alt="A Word Cloud from the Sakai Developer List" class="align-center" src="../_images/wordcloud.png" style="width: 574.0px; height: 613.9px;" /></a>
<p>You can download this application from:</p>
<p><a class="reference external" href="http://www.py4e.com/code3/gmane.zip">www.py4e.com/code3/gmane.zip</a></p>
<p>We will be using data from a free email list archiving service called
<a class="reference external" href="http://www.gmane.org">www.gmane.org</a>. This service is very popular with open
source projects because it provides a nice searchable archive of their
email activity. They also have a very liberal policy regarding accessing
their data through their API. They have no rate limits, but ask that you
don’t overload their service and take only the data you need. You can
read gmane’s terms and conditions at this page:</p>
<p><a class="reference external" href="http://gmane.org/export.php">http://gmane.org/export.php</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is very important that you make use of the gmane.org data responsibly by adding
delays to your access of their services and spreading long-running jobs over a longer
period of time. Do not abuse this free service and ruin it for the rest of us.</p>
</div>
<p>When the Sakai email data was spidered using this software, it produced
nearly a Gigabyte of data and took a number of runs on several days. The
file <em>README.txt</em> in the above ZIP may have instructions
as to how you can download a pre-spidered copy of the
<em>content.sqlite</em> file for a majority of the Sakai email
corpus so you don’t have to spider for five days just to run the
programs. If you download the pre-spidered content, you should still run
the spidering process to catch up with more recent messages.</p>

    <div class="runestone ">
    <ul data-component="multiplechoice" data-question_label="22.4.1" data-multipleanswers="false"  id="viz-mail-MC-tf"  style="visibility: hidden;">
    <p>csp-10-2-1: True or False? When running the following program, it is required to spider the Sakai email data.</p>

    <li data-component="answer"  id="viz-mail-MC-tf_opt_a">True</li><li data-component="feedback">Try again! In the README.txt file, there are instructions to download a pre-spidered file.</li>
    
    <li data-component="answer" data-correct='yes' id="viz-mail-MC-tf_opt_b">False</li><li data-component="feedback">In the README.txt file, there are instructions to download a pre-spidered file. It is useful to spider after this, to stay up to date on new messages.</li>
    

    </ul>
    </div>
    <p>The first step is to spider the gmane repository. The base URL is
hard-coded in the <em>gmane.py</em> and is hard-coded to the
Sakai developer list. You can spider another repository by changing that
base url. Make sure to delete the <em>content.sqlite</em> file
if you switch the base url.</p>
<p>The <em>gmane.py</em> file operates as a responsible caching
spider in that it runs slowly and retrieves one mail message per second
so as to avoid getting throttled by gmane. It stores all of its data in
a database and can be interrupted and restarted as often as needed. It
may take many hours to pull all the data down. So you may need to
restart several times.</p>
<p>Here is a run of <em>gmane.py</em> retrieving the last five
messages of the Sakai developer list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">How</span> <span class="n">many</span> <span class="n">messages</span><span class="p">:</span><span class="mi">10</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">gmane</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gmane</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">sakai</span><span class="o">.</span><span class="n">devel</span><span class="o">/</span><span class="mi">51410</span><span class="o">/</span><span class="mi">51411</span> <span class="mi">9460</span>
    <span class="n">nealcaidin</span><span class="nd">@sakaifoundation</span><span class="o">.</span><span class="n">org</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span> <span class="n">re</span><span class="p">:</span> <span class="p">[</span><span class="n">building</span> <span class="o">...</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">gmane</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gmane</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">sakai</span><span class="o">.</span><span class="n">devel</span><span class="o">/</span><span class="mi">51411</span><span class="o">/</span><span class="mi">51412</span> <span class="mi">3379</span>
    <span class="n">samuelgutierrezjimenez</span><span class="nd">@gmail</span><span class="o">.</span><span class="n">com</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">06</span> <span class="n">re</span><span class="p">:</span> <span class="p">[</span><span class="n">building</span> <span class="o">...</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">gmane</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gmane</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">sakai</span><span class="o">.</span><span class="n">devel</span><span class="o">/</span><span class="mi">51412</span><span class="o">/</span><span class="mi">51413</span> <span class="mi">9903</span>
    <span class="n">da1</span><span class="nd">@vt</span><span class="o">.</span><span class="n">edu</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span> <span class="p">[</span><span class="n">building</span> <span class="n">sakai</span><span class="p">]</span> <span class="n">melete</span> <span class="mf">2.9</span> <span class="n">oracle</span> <span class="o">...</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">gmane</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gmane</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">sakai</span><span class="o">.</span><span class="n">devel</span><span class="o">/</span><span class="mi">51413</span><span class="o">/</span><span class="mi">51414</span> <span class="mi">349265</span>
    <span class="n">m</span><span class="o">.</span><span class="n">shedid</span><span class="nd">@elraed</span><span class="o">-</span><span class="n">it</span><span class="o">.</span><span class="n">com</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">07</span> <span class="p">[</span><span class="n">building</span> <span class="n">sakai</span><span class="p">]</span> <span class="o">...</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">gmane</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gmane</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">sakai</span><span class="o">.</span><span class="n">devel</span><span class="o">/</span><span class="mi">51414</span><span class="o">/</span><span class="mi">51415</span> <span class="mi">3481</span>
    <span class="n">samuelgutierrezjimenez</span><span class="nd">@gmail</span><span class="o">.</span><span class="n">com</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">07</span> <span class="n">re</span><span class="p">:</span> <span class="o">...</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">gmane</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gmane</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">sakai</span><span class="o">.</span><span class="n">devel</span><span class="o">/</span><span class="mi">51415</span><span class="o">/</span><span class="mi">51416</span> <span class="mi">0</span>

<span class="n">Does</span> <span class="ow">not</span> <span class="n">start</span> <span class="k">with</span> <span class="n">From</span>
</pre></div>
</div>
<p>The program scans <em>content.sqlite</em> from one up to the
first message number not already spidered and starts spidering at that
message. It continues spidering until it has spidered the desired number
of messages or it reaches a page that does not appear to be a properly
formatted message.</p>
<p>Sometimes <a class="reference external" href="gmane.org">gmane.org</a> is missing a message. Perhaps
administrators can delete messages or perhaps they get lost. If your
spider stops, and it seems it has hit a missing message, go into the
SQLite Manager and add a row with the missing id leaving all the other
fields blank and restart <em>gmane.py</em>. This will unstick
the spidering process and allow it to continue. These empty messages
will be ignored in the next phase of the process.</p>
<p>One nice thing is that once you have spidered all of the messages and
have them in <em>content.sqlite</em>, you can run
<em>gmane.py</em> again to get new messages as they are sent to
the list.</p>
<p>The <em>content.sqlite</em> data is pretty raw, with an
inefficient data model, and not compressed. This is intentional as it
allows you to look at <em>content.sqlite</em> in the SQLite
Manager to debug problems with the spidering process. It would be a bad
idea to run any queries against this database, as they would be quite
slow.</p>
<p>The second process is to run the program <em>gmodel.py</em>.
This program reads the raw data from <em>content.sqlite</em> and
produces a cleaned-up and well-modeled version of the data in the file
<em>index.sqlite</em>. This file will be much smaller (often 10X
smaller) than <em>content.sqlite</em> because it also compresses
the header and body text.</p>
<p>Each time <em>gmodel.py</em> runs it deletes and rebuilds
<em>index.sqlite</em>, allowing you to adjust its parameters and
edit the mapping tables in <em>content.sqlite</em> to tweak the
data cleaning process. This is a sample run of
<em>gmodel.py</em>. It prints a line out each time 250 mail
messages are processed so you can see some progress happening, as this
program may run for a while processing nearly a Gigabyte of mail data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Loaded</span> <span class="n">allsenders</span> <span class="mi">1588</span> <span class="ow">and</span> <span class="n">mapping</span> <span class="mi">28</span> <span class="n">dns</span> <span class="n">mapping</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">08</span><span class="n">T23</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">30</span><span class="o">-</span><span class="mi">06</span><span class="p">:</span><span class="mi">00</span> <span class="n">ggolden22</span><span class="nd">@mac</span><span class="o">.</span><span class="n">com</span>
<span class="mi">251</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">22</span><span class="n">T10</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="mi">20</span><span class="o">-</span><span class="mi">08</span><span class="p">:</span><span class="mi">00</span> <span class="n">tpamsler</span><span class="nd">@ucdavis</span><span class="o">.</span><span class="n">edu</span>
<span class="mi">501</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">12</span><span class="n">T11</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">34</span><span class="o">-</span><span class="mi">05</span><span class="p">:</span><span class="mi">00</span> <span class="n">lance</span><span class="nd">@indiana</span><span class="o">.</span><span class="n">edu</span>
<span class="mi">751</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">24</span><span class="n">T11</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="o">-</span><span class="mi">08</span><span class="p">:</span><span class="mi">00</span> <span class="n">vrajgopalan</span><span class="nd">@ucmerced</span><span class="o">.</span><span class="n">edu</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The <em>gmodel.py</em> program handles a number of data cleaning
tasks.</p>
<p>Domain names are truncated to two levels for .com, .org, .edu, and .net.
Other domain names are truncated to three levels. So si.umich.edu
becomes umich.edu and caret.cam.ac.uk becomes cam.ac.uk. Email addresses
are also forced to lower case, and some of the &#64;gmane.org address like
the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arwhyte</span><span class="o">-</span><span class="mi">63</span><span class="n">aXycvo3TyHXe</span><span class="o">+</span><span class="n">LvDLADg</span><span class="nd">@public</span><span class="o">.</span><span class="n">gmane</span><span class="o">.</span><span class="n">org</span>
</pre></div>
</div>
<p>are converted to the real address whenever there is a matching real
email address elsewhere in the message corpus.</p>
<p>In the <em>mapping.sqlite</em> database there are two tables
that allow you to map both domain names and individual email addresses
that change over the lifetime of the email list. For example, Steve
Githens used the following email addresses as he changed jobs over the
life of the Sakai developer list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">-</span><span class="n">githens</span><span class="nd">@northwestern</span><span class="o">.</span><span class="n">edu</span>
<span class="n">sgithens</span><span class="nd">@cam</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk</span>
<span class="n">swgithen</span><span class="nd">@mtu</span><span class="o">.</span><span class="n">edu</span>
</pre></div>
</div>
<p>We can add two entries to the Mapping table in
<em>mapping.sqlite</em> so <em>gmodel.py</em> will map
all three to one address:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">-</span><span class="n">githens</span><span class="nd">@northwestern</span><span class="o">.</span><span class="n">edu</span> <span class="o">-&gt;</span>  <span class="n">swgithen</span><span class="nd">@mtu</span><span class="o">.</span><span class="n">edu</span>
<span class="n">sgithens</span><span class="nd">@cam</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk</span> <span class="o">-&gt;</span> <span class="n">swgithen</span><span class="nd">@mtu</span><span class="o">.</span><span class="n">edu</span>
</pre></div>
</div>
<p>You can also make similar entries in the DNSMapping table if there are
multiple DNS names you want mapped to a single DNS. The following
mapping was added to the Sakai data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iupui</span><span class="o">.</span><span class="n">edu</span> <span class="o">-&gt;</span> <span class="n">indiana</span><span class="o">.</span><span class="n">edu</span>
</pre></div>
</div>
<p>so all the accounts from the various Indiana University campuses are
tracked together.</p>
<p>You can rerun the <em>gmodel.py</em> over and over as you look
at the data, and add mappings to make the data cleaner and cleaner. When
you are done, you will have a nicely indexed version of the email in
<em>index.sqlite</em>. This is the file to use to do data
analysis. With this file, data analysis will be really quick.</p>
<p>The first, simplest data analysis is to determine “who sent the most
mail?” and “which organization sent the most mail”? This is done using
<em>gbasic.py</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>How many to dump? 5
Loaded messages= 51330 subjects= 25033 senders= 1584

Top 5 Email list participants
steve.swinsburg@gmail.com 2657
azeckoski@unicon.net 1742
ieb@tfd.co.uk 1591
csev@umich.edu 1304
david.horwitz@uct.ac.za 1184

Top 5 Email list organizations
gmail.com 7339
umich.edu 6243
uct.ac.za 2451
indiana.edu 2258
unicon.net 2055
</pre></div>
</div>
<p>Note how much more quickly <em>gbasic.py</em> runs compared to
<em>gmane.py</em> or even <em>gmodel.py</em>. They are
all working on the same data, but <em>gbasic.py</em> is using
the compressed and normalized data in <em>index.sqlite</em>. If
you have a lot of data to manage, a multistep process like the one in
this application may take a little longer to develop, but will save you
a lot of time when you really start to explore and visualize your data.</p>
<p>You can produce a simple visualization of the word frequency in the
subject lines in the file <em>gword.py</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Range</span> <span class="n">of</span> <span class="n">counts</span><span class="p">:</span> <span class="mi">33229</span> <span class="mi">129</span>
<span class="n">Output</span> <span class="n">written</span> <span class="n">to</span> <span class="n">gword</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>This produces the file <em>gword.js</em> which you can visualize
using <em>gword.htm</em> to produce a word cloud similar to the
one at the beginning of this section.</p>
<p>A second visualization is produced by <em>gline.py</em>. It
computes email participation by organizations over time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Loaded</span> <span class="n">messages</span><span class="o">=</span> <span class="mi">51330</span> <span class="n">subjects</span><span class="o">=</span> <span class="mi">25033</span> <span class="n">senders</span><span class="o">=</span> <span class="mi">1584</span>
<span class="n">Top</span> <span class="mi">10</span> <span class="n">Oranizations</span>
<span class="p">[</span><span class="s1">&#39;gmail.com&#39;</span><span class="p">,</span> <span class="s1">&#39;umich.edu&#39;</span><span class="p">,</span> <span class="s1">&#39;uct.ac.za&#39;</span><span class="p">,</span> <span class="s1">&#39;indiana.edu&#39;</span><span class="p">,</span>
<span class="s1">&#39;unicon.net&#39;</span><span class="p">,</span> <span class="s1">&#39;tfd.co.uk&#39;</span><span class="p">,</span> <span class="s1">&#39;berkeley.edu&#39;</span><span class="p">,</span> <span class="s1">&#39;longsight.com&#39;</span><span class="p">,</span>
<span class="s1">&#39;stanford.edu&#39;</span><span class="p">,</span> <span class="s1">&#39;ox.ac.uk&#39;</span><span class="p">]</span>
<span class="n">Output</span> <span class="n">written</span> <span class="n">to</span> <span class="n">gline</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>Its output is written to <em>gline.js</em> which is visualized
using <em>gline.htm</em>.</p>
<a class="reference internal image-reference" href="../_images/mailorg.png"><img alt="Sakai Mail Activity by Organization" class="align-center" src="../_images/mailorg.png" style="width: 857.5px; height: 478.79999999999995px;" /></a>
<p>This is a relatively complex and sophisticated application and has
features to do some real data retrieval, cleaning, and visualization.</p>
</section>


  <div id="scprogresscontainer">
    You have attempted <span id="scprogresstotal"></span> of <span id="scprogressposs"></span> activities on this page <div id="subchapterprogress" aria-label="Page progress"></div>
  </div>

  <ul role="navigation" class="nextprev-list nextprev-list" aria-label="Change page">
<li id="relations-prev" class="navLink" title='Previous Section - 22.3. Visualizing networks and interconnections' data-toggle="tooltip">
  <a href="visualizingnetworksandinterconnections.html" aria-label="Previous - 22.3. Visualizing networks and interconnections">
    <i class='prevNav glyphicon glyphicon-chevron-left'  style="top:50%; transform:translateY(-50%)translateX(-50%); left: 50%; color:black;"></i>
  </a>
</li>

  <li id="relations-next" class="navLink" title='Next Section - 22.5. Multiple Choice Questions' data-toggle="tooltip" >
    <a href="Exercises.html" aria-label="Next - 22.5. Multiple Choice Questions">
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right' style="top:50%; transform:translateY(-50%)translateX(-50%); left: 50%; color:black; "></i>
    </a>
  </li>
</ul>

<script>
window.addEventListener('load', (event) => {
  $('#relations-prev').tooltip({'placement': 'right', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement': 'left', 'delay': { show: 100, hide: 50}});
});
</script>

</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      
      <span id='numuserspan'></span><span class='loggedinuser'></span>
      
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020 - Based on Python for Everybody.
      Created using <a href="http://runestoneinteractive.org/">Runestone</a> .
    </p>
  </div>
</footer>



  
    {% if settings.google_ga %}
      <script>
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', '{{ settings.google_ga }}']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>
    {% endif %}
  

  
    <script type="application/json" class="js-hypothesis-config">
    {
      "showHighlights": false
    }
    </script>

    <script async src="https://hypothes.is/embed.js"></script>
    <!--provide space to prevent hypothes.is sidebar from obscuring content-->
    <style>@media screen and (max-width:767px) { body { padding-right: 21px; }}</style>

  


<script>
  window.addEventListener('load', (event) => {
    runestoneComponents.getSwitch();
  });
</script>


  </body>
</html>